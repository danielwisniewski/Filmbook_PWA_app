<app-loading-spinner *ngIf="isLoading"></app-loading-spinner>

<div class="container" *ngIf="!isLoading">
  <!-- <div class="first-view-content">
    <mat-card class="card">
      <mat-card-header class="first-view-header">
        <img mat-card-xl-image [src]="filmData.poster " />
        <h4 class="mt-3">{{ filmData.title }}</h4>
      </mat-card-header>
      <mat-card-subtitle class="first-view-subtitle" style="margin-bottom: 4px">
        {{ filmData.type | titlecase }} {{ filmData.service | uppercase }}
      </mat-card-subtitle>
      <mat-card-content class="card-content">
        <mat-grid-list cols="2" rowHeight="3rem">
          <mat-grid-tile>{{ filmData.year }}</mat-grid-tile>
          <mat-grid-tile
            ><mat-icon>star_rating</mat-icon>
            <span class="rating">{{
              filmData.rating | number: "1.1-1"
            }}</span></mat-grid-tile
          >
          <mat-grid-tile>{{ filmData.duration }}</mat-grid-tile>
          <mat-grid-tile>{{ filmData.country }}</mat-grid-tile>
          <mat-grid-tile colspan="2" *ngIf="filmData.director"
            >Reżyseria: {{ filmData.director }}</mat-grid-tile
          >
          <mat-grid-tile
            colspan="2"
            *ngIf="filmData.awards"
            class="text-center"
            routerLink="awards"
            >{{ filmData.awards }}
            <mat-icon id="awardsLink">
              keyboard_arrow_right
            </mat-icon></mat-grid-tile
          >
        </mat-grid-list>
      </mat-card-content>
      <mat-card-actions class="action-buttons mb-2">
        <button
          mat-raised-button
          class="action-button"
          [color]="filmData.watchlist ? 'primary' : 'accent'"
          (click)="onWatchlist()"
          [disabled]="filmData.seen"
        >
          Chcę obejrzeć!
        </button>
        <button
          mat-raised-button
          class="action-button"
          (click)="addToSeenClicked()"
          [color]="filmData.seen ? 'primary' : 'accent'"
        >
          {{ filmData.seen ? "Zmień ocenę - " + filmData.myRating  : "Obejrzałem" }}
        </button>
      </mat-card-actions>
    </mat-card>
  </div> -->
  <app-initial-view [filmData]="filmData"></app-initial-view>
  <div class="second-view-content">
    <app-tv-seances *ngIf="tvSeances?.length > 0" [tvSeances]="tvSeances" ></app-tv-seances>
    <div class="mt-2 mb-2 genre">
      <h5 class="text-center">Gatunek</h5>
      <mat-chip-list>
        <mat-chip
          *ngFor="let genre of filmData.genre"
          class="mt-2 mb-2"
          [routerLink]="'/genre/' + genre"
          >{{ genre }}</mat-chip
        >
      </mat-chip-list>
    </div>
    <div class="plot">
      <h5 class="text-center">Fabuła</h5>
      <p>
        {{ filmData.plot }}
      </p>
    </div>
    <div class="plot" *ngIf="filmData.longPlot.length > 0">
      <mat-expansion-panel id="ExtendedPlot">
        <mat-expansion-panel-header>
          <mat-panel-title>Rozszerzona fabuła</mat-panel-title>
        </mat-expansion-panel-header>
        <p>{{ filmData.longPlot }}</p>
      </mat-expansion-panel>
    </div>
    <div class="mt-2 cast-container">
      <h5 class="text-center cast-title" (click)="onCast()">Obsada <mat-icon id="awardsLink">
        keyboard_arrow_right
      </mat-icon></h5>
      <div class="cast">
        <mat-card *ngFor="let person of filmData.cast" class="cast-element">
          <img mat-card-avatar [src]="person.picture" />
          <p class="text-center mt-2">{{ person.actor }}</p>
        </mat-card>
      </div>
    </div>
    <div class="plot" *ngIf="filmData.facts.length > 0">
      <h5 class="text-center">Ciekawostki</h5>
      <mat-accordion>
        <mat-expansion-panel *ngFor="let fact of filmData.facts; let i = index">
          <mat-expansion-panel-header>
            <mat-panel-title>{{ fact.substring(0, 35) }}...</mat-panel-title>
            <mat-panel-description></mat-panel-description>
          </mat-expansion-panel-header>
          <p>{{ fact }}</p>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
    <div class="filmweb-link">
      <a
        mat-raised-button
        color="accent"
        target="_self"
        [href]="filmData.filmwebUrl"
        >Otwórz w Filmweb</a
      >
    </div>
  </div>
</div>
